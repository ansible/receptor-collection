---
- node:
    id: {{ (receptor_host_identifier == 'localhost') | ternary('localhost.localdomain', receptor_host_identifier) }}

- log-level: {{ receptor_log_level }}

- control-service:
    service: {{ receptor_control_service }}
    filename: {{ receptor_socket_dir }}/{{ receptor_control_filename }}
    permissions: 0660

{% if receptor_local_only %}
- local-only
{% elif receptor_listener %}
- {{ receptor_protocol }}-listener:
    port: {{ receptor_port }}
{% endif %}

{% if receptor_work_commands is defined -%}
{% for command, config in receptor_work_commands.items() %}
- work-command:
    worktype: {{ command }}
{% for key, value in config.items() %}
    {{ key }}: {{ value }}
{% endfor %}
{% endfor %}
{%- endif %}

{%- if receptor_kubernetes_commands is defined %}
{% for command, config in receptor_kubernetes_commands.items() %}
- work-kubernetes:
    worktype: {{ command }}
{% for key, value in config.items() %}
    {{ key }}: {{ value }}
{% endfor %}
{% endfor %}
{% endif -%}
